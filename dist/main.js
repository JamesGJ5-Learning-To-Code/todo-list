(()=>{"use strict";class t{constructor({title:t,objectId:e}){this.title=t,this.objectId=e,this.todoList=[],this.nextObjectId=0,this.soonestDueDate=void 0,this.parentAllProjects=void 0}set title(t){this._title=t||"Nameless Project"}get title(){return this._title}set soonestDueDate(t){this._soonestDueDate=t,this.priority=t||-1/0}get soonestDueDate(){return this._soonestDueDate}set priority(t){if(t===-1/0)this._priority=t;else{const e=parseInt(t.replace("-","").replace("-",""));this._priority=-e}this.parentAllProjects&&this.parentAllProjects.sortByPriority()}get priority(){return this._priority}set nextObjectId(t){this._nextObjectId=t}get nextObjectId(){const t=this._nextObjectId;return this.nextObjectId=t+1,t}add(t){this.todoList.push(t),t.parentProject=this,this.sortByPriority()}sortByPriority(){this.todoList.sort(((t,e)=>e.priority-t.priority)),this.soonestDueDate=this.todoList[0].dueDate}getIndex(t){return this.todoList.findIndex((e=>e.objectId===t))}remove(t){this.todoList.splice(t,1),this.soonestDueDate=this.todoList[0]?this.todoList[0].dueDate:void 0}}class e{constructor({title:t,dueDate:e,description:o,objectId:r}){this.title=t,this.dueDate=e,this.description=o,this.objectId=r,this.parentProject=void 0}set dueDate(t){this._dueDate=t,this.priority=t||-1/0}get dueDate(){return this._dueDate}set priority(t){if(t===-1/0)this._priority=t;else{const e=parseInt(t.replace("-","").replace("-",""));this._priority=-e}this.parentProject&&this.parentProject.sortByPriority()}get priority(){return this._priority}}const o=new class{constructor(){this.projectList=[],this.nextObjectId=0}set nextObjectId(t){this._nextObjectId=t}get nextObjectId(){const t=this._nextObjectId;return this.nextObjectId=t+1,t}add(t){this.projectList.push(t),this.sortByPriority(),t.parentAllProjects=this}sortByPriority(){this.projectList.sort(((t,e)=>e.priority-t.priority))}getIndex(t){return this.projectList.findIndex((e=>e.objectId===t))}remove(t){this.projectList.splice(t,1)}};new class{constructor(o){this.allProjects=o,this.newProjectButton=document.querySelector("#new-project-button"),this.newProjectForm=document.querySelector("#new-project-form"),this.allProjectsDiv=document.querySelector("#all-projects"),this.newTodoForm=document.querySelector("#new-todo-form"),this.newProjectButton.addEventListener("click",(()=>{this.newProjectForm.classList.toggle("hidden")})),this.newProjectForm.querySelector("button").addEventListener("click",(e=>{const o=(()=>{const e=document.querySelector("#new-project-title").value;return new t({title:e,objectId:this.allProjects.nextObjectId})})();this.allProjects.add(o),((t,e)=>{const o=this.allProjectsDiv;0===o.childElementCount?o.appendChild(t):o.insertBefore(t,o.childNodes[e])})((t=>{const e=document.createElement("form");e.setAttribute("data-object-id",t.objectId);const o=((t,e)=>{const o=document.createElement("input");o.value=t,o.disabled=!0;const r=`project-${e}-input`;return o.name=r,o.id=r,o})(t.title,t.objectId),r=(t=>{const e=document.createElement("label");return e.textContent="Project Title: ",e.setAttribute("for",t.id),e})(o),s=(()=>{const t=document.createElement("div");return t.textContent="Soonest Due Date: N/A",t.classList.add("soonest-due-date"),t})(),n=(()=>{const t=document.createElement("button");return t.type="button",t.textContent="Edit Project",t.classList.add("edit-project"),t})(),i=(()=>{const t=document.createElement("button");return t.type="button",t.textContent="Delete Project",t.classList.add("delete-project"),t})(),d=(()=>{const t=document.createElement("button");return t.type="button",t.textContent="Open/Close Todo List",t.classList.add("toggle-todo-list"),t})(),c=(()=>{const t=document.createElement("button");return t.type="button",t.textContent="Create Todo",t.classList.add("create-todo"),t.classList.add("hidden"),t})(),a=(()=>{const t=document.createElement("div");return t.classList.add("todo-list"),t.classList.add("hidden"),t})();return e.appendChild(r),e.appendChild(o),e.appendChild(s),e.appendChild(n),e.appendChild(i),e.appendChild(d),e.appendChild(c),e.appendChild(a),e})(o),this.allProjects.getIndex(o.objectId)),(()=>{this.newProjectForm.reset(),this.newProjectForm.classList.add("hidden")})()})),this.allProjectsDiv.addEventListener("click",(t=>{if(t.target&&t.target.classList.contains("edit-project")){const e=()=>{t.target.parentNode.querySelector("input").disabled=!1},o=()=>{const t=document.createElement("button");return t.type="button",t.textContent="Submit",t.classList.add("submit-edit-project"),t},r=()=>{((t,e)=>{const o=document.querySelector(".soonest-due-date");e.insertBefore(t,o.nextElementSibling)})(o(),t.target.parentNode)};if(t.target.parentNode.querySelector(".submit-edit-project"))return;e(),r()}})),this.allProjectsDiv.addEventListener("click",(t=>{if(t.target&&t.target.classList.contains("submit-edit-project")){const e=()=>{t.target.remove()};(e=>{const o=t.target.parentNode.querySelector("input");e.title=o.value,o.disabled=!0})((t=>{const e=this.allProjects.getIndex(t);return this.allProjects.projectList[e]})((()=>{const e=t.target.parentNode;return parseInt(e.getAttribute("data-object-id"))})())),e()}})),this.allProjectsDiv.addEventListener("click",(t=>{if(t.target&&t.target.classList.contains("delete-project")){const e=t=>{const e=parseInt(t.getAttribute("data-object-id")),r=o.getIndex(e);o.remove(r),console.log(o.projectList)},r=t=>{t.remove()};(()=>{const o=t.target.parentNode;e(o),r(o)})()}})),this.allProjectsDiv.addEventListener("click",(t=>{if(t.target&&t.target.classList.contains("toggle-todo-list")){const e=()=>{t.target.parentNode.querySelector(".todo-list").classList.toggle("hidden")};t.target.parentNode.querySelector(".create-todo").classList.toggle("hidden"),e()}})),this.allProjectsDiv.addEventListener("click",(t=>{if(t.target&&t.target.classList.contains("create-todo")){const e=()=>{this.newTodoForm.classList.toggle("hidden")};(()=>{const e=document.querySelector("#new-todo-form");t.target.parentNode.insertBefore(e,t.target.nextSibling)})(),e()}})),this.newTodoForm.querySelector("button").addEventListener("click",(t=>{const o=(t,e,o,r)=>{const s=document.createElement("input");s.type=t,s.value=o,s.disabled=!0;const n=`todo-${r}-${e}-input`;return s.name=n,s.id=n,s.setAttribute("data-attribute",e),s},r=(t,e)=>{const o=document.createElement("label");return o.textContent=e,o.setAttribute("for",t.id),o},s=(()=>{const t=parseInt(this.newTodoForm.parentNode.getAttribute("data-object-id")),e=this.allProjects.getIndex(t);return this.allProjects.projectList[e]})(),n=(t=>{const o=document.querySelector("#new-todo-title").value,r=document.querySelector("#new-todo-due-date").value,s=document.querySelector("#new-todo-description").value,n=t.nextObjectId;return new e({title:o,dueDate:r,description:s,objectId:n})})(s);s.add(n),((t,e)=>{const o=this.newTodoForm.parentNode.querySelector(".todo-list");0===o.childElementCount?o.appendChild(t):o.insertBefore(t,o.childNodes[e])})((t=>{const e=document.createElement("form");e.setAttribute("data-object-id",t.objectId);const s=o("text","title",t.title,t.objectId),n=r(s,"Todo Item Title: "),i=o("date","dueDate",t.dueDate,t.objectId),d=r(i,"Due Date: "),c=o("text","description",t.description,t.objectId),a=r(c,"Description: "),l=(()=>{const t=document.createElement("button");return t.type="button",t.textContent="Edit Todo",t.classList.add("edit-todo"),t})(),u=(()=>{const t=document.createElement("button");return t.type="button",t.textContent="Delete Todo",t.classList.add("delete-todo"),t})();return e.appendChild(n),e.appendChild(s),e.appendChild(d),e.appendChild(i),e.appendChild(a),e.appendChild(c),e.appendChild(l),e.appendChild(u),e})(n),s.getIndex(n.objectId)),(()=>{this.newTodoForm.reset(),this.newTodoForm.classList.add("hidden")})(),(e=>{const o=t.target.parentNode.parentNode;this.updateSoonestDueDateDiv(o,e),this.updateDOMPosition(o)})(s)})),this.allProjectsDiv.addEventListener("click",(t=>{if(t.target&&t.target.classList.contains("edit-todo")){const e=()=>{t.target.parentNode.querySelectorAll("input").forEach((t=>{t.disabled=!1}))},o=()=>{const t=document.createElement("button");return t.type="button",t.textContent="Submit",t.classList.add("submit-edit-todo"),t},r=()=>{const e=o();t.target.parentNode.appendChild(e)};if(t.target.parentNode.querySelector(".submit-edit-todo"))return;e(),r()}})),this.allProjectsDiv.addEventListener("click",(t=>{if(t.target&&t.target.classList.contains("submit-edit-todo")){const e=()=>{const e=t.target.parentNode.parentNode.parentNode,o=parseInt(e.getAttribute("data-object-id")),r=this.allProjects.getIndex(o);return this.allProjects.projectList[r]},o=(t,e)=>{const o=t.getIndex(e);return t.todoList[o]},r=e=>{t.target.parentNode.querySelectorAll("input").forEach((t=>{const o=t.getAttribute("data-attribute");e[o]=t.value,t.disabled=!0}))},s=(e,o)=>{const r=t.target.parentNode,s=t.target.parentNode.parentNode,n=o.getIndex(e);s.insertBefore(r,s.childNodes[n])},n=e=>{const o=t.target.parentNode.parentNode.parentNode;this.updateSoonestDueDateDiv(o,e),this.updateDOMPosition(o)},i=()=>{t.target.remove()},d=(()=>{const e=t.target.parentNode;return parseInt(e.getAttribute("data-object-id"))})(),c=e();r(o(c,d)),s(d,c),n(c),i()}})),this.allProjectsDiv.addEventListener("click",(t=>{if(t.target&&t.target.classList.contains("delete-todo")){const e=()=>{const e=t.target.parentNode.parentNode.parentNode,o=parseInt(e.getAttribute("data-object-id")),r=this.allProjects.getIndex(o);return this.allProjects.projectList[r]},o=t=>{const o=parseInt(t.getAttribute("data-object-id")),r=e(),s=r.getIndex(o);r.remove(s)},r=e=>{const o=t.target.parentNode.parentNode.parentNode;this.updateSoonestDueDateDiv(o,e),this.updateDOMPosition(o)},s=t=>{t.remove()};(()=>{const n=t.target.parentNode;o(n),r(e()),s(n)})()}}))}updateSoonestDueDateDiv(t,e){const o=t.querySelector(".soonest-due-date"),r=e.soonestDueDate;let s;s=r?r.toString():"N/A",o.textContent=`Soonest Due Date: ${s}`}updateDOMPosition(t){const e=parseInt(t.getAttribute("data-object-id")),o=this.allProjects.getIndex(e);t.remove(),this.allProjectsDiv.insertBefore(t,this.allProjectsDiv.childNodes[o])}}(o)})();